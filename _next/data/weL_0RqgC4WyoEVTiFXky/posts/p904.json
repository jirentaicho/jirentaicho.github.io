{"pageProps":{"frontMatter":{"title":"Laravel sailのphpバージョンを下げる","date":"2022.01.21","description":"Laravel sailのphpバージョンを下げる","categories":["Laravel"]},"content":"<p>環境によってはphpのバージョンを下げる必要があるのでメモ</p>\n<p>sailでプロジェクトを作成した後のdocker-compose.yamlを修正する。</p>\n<p>修正箇所は２か所で、contextとimageの部分です。</p>\n<div class=\"remark-highlight\"><pre class=\"language-html\"><code class=\"language-html\">laravel.test:\n        build:\n            context: ./vendor/laravel/sail/runtimes/7.4 #変更\n            dockerfile: Dockerfile\n            args:\n                WWWGROUP: '${WWWGROUP}'\n        image: sail-7.4/app #変更\n        extra_hosts:\n            - 'host.docker.internal:host-gateway'\n        ports:\n            - '${APP_PORT:-80}:80'\n        environment:\n            WWWUSER: '${WWWUSER}'\n            LARAVEL_SAIL: 1\n            XDEBUG_MODE: '${SAIL_XDEBUG_MODE:-off}'\n            XDEBUG_CONFIG: '${SAIL_XDEBUG_CONFIG:-client_host=host.docker.internal}'\n        volumes:\n            - '.:/var/www/html'\n        networks:\n            - sail\n        depends_on:\n            - mysql\n            - redis\n            - meilisearch\n            - selenium\n</code></pre></div>\n<p>次にcomposerのphpバージョンも合わせるように修正する</p>\n<div class=\"remark-highlight\"><pre class=\"language-unknown\"><code class=\"language-unknown\">./vendor/bin/sail up -d\r\n./vendor/bin/sail shell\r\ncomposer config platform.php 7.4\r\r\ncomposer update</code></pre></div>\n<p>こんなエラーが解消される</p>\n<div class=\"remark-highlight\"><pre class=\"language-unknown\"><code class=\"language-unknown\">laravel.test_1  | 2022-01-21 01:29:56,889 INFO exited: php (exit status 255; not expected)\r\r\nlaravel.test_1  | 2022-01-21 01:29:57,892 INFO spawned: &#x26;#39;php&#x26;#39; with pid 19\r\r\nlaravel.test_1  | Composer detected issues in your platform:\r\r\nlaravel.test_1  |\r\r\nlaravel.test_1  | Your Composer dependencies require a PHP version &#x26;quot;&#x26;gt;= 8.0.2&#x26;quot;. You are running 7.4.27.\r\r\nlaravel.test_1  |\r\r\nlaravel.test_1  | PHP Fatal error:  Composer detected issues in your platform: Your Composer dependencies require a PHP version &#x26;quot;&#x26;gt;= 8.0.2&#x26;quot;. You are running 7.4.27. in /var/www/html/vendor/composer/platform_check.php on line 24\r\r\nlaravel.test_1  | 2022-01-21 01:29:58,912 INFO success: php entered RUNNING state, process has stayed up for &#x26;gt; than 1 seconds (st</code></pre></div>","slug":"p904"},"__N_SSG":true}