{"pageProps":{"frontMatter":{"title":"Spring | メッセージの定義をする","date":"2022.04.14","description":"Spring | メッセージの定義をする","categories":["Spring"]},"content":"<p>Javaのプロジェクトはメッセージに関するデータは別途プロパティファイルなどで管理することが多いです。</p>\n<p>今回は普通のメッセージとエラーメッセージについて記載します。</p>\n<ul>\n<li>通常のメッセージ\n<ul>\n<li>messages.propertiesresourcesの下に作成します</li>\n<li>MessageSourceクラスで読み込みます</li>\n<li>個別で上書きしたいBean Validationのエラーメッセージ、Spring Validatorで実装した入力チェックのエラーメッセージ\n<ul>\n<li>resourcesの下に作成します</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>エラーメッセージ\n<ul>\n<li>ValidationMessages.properties</li>\n<li>システムで定めたBean Validationのデフォルトエラーメッセージ</li>\n</ul>\n</li>\n</ul>\n<p>参考サイト</p>\n<p>http://terasolunaorg.github.io/guideline/current/ja/ArchitectureInDetail/WebApplicationDetail/MessageManagement.html</p>\n<h2>通常のメッセージ</h2>\n<p>messages.propertiesというファイルをresourcesフォルダに作成します</p>\n<p><img src=\"/2101/1.png\" alt=\"画像\"></p>\n<p>KEY=VALUEの形式でメッセージを作成します。環境によっては以下のように表示されるかもしれませんが問題はありません。また{0}は埋め込み文字としてソースコードから文字列を埋め込むことができます。</p>\n<div class=\"remark-highlight\"><pre class=\"language-unknown\"><code class=\"language-unknown\">M_MESSAGE01=\\u3053\\u308C\\u306F{0}\\u306E\\u30B7\\u30B9\\u30C6\\u30E0\\u3067\\u3059</code></pre></div>\n<p>これをMessageSourceクラスを利用して取得します。</p>\n<div class=\"remark-highlight\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Autowired</span>\n\t<span class=\"token keyword\">private</span> <span class=\"token class-name\">MessageSource</span> messageSource<span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token annotation punctuation\">@RequestMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/message\"</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>messageSource<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"M_MESSAGE01\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"Store\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>getMessageメソッドの第二引数は埋め込み文字を配列で渡します。第三引数は言語設定がある場合にjava.util.Localeを渡します。</p>\n<p>画面から実行してみます。</p>\n<p><img src=\"/2101/2.png\" alt=\"画像\"></p>\n<h2>エラーメッセージ</h2>\n<p>アノテーションを付与すると自動的にそれに応じたエラーメッセージが表示されますが、そのエラーメッセージをカスタマイズできます</p>\n<p>とりあえず既存（デフォルト）のエラーメッセージを変更したい時は、ValidationMessages.propertiesを利用する。</p>\n<p>ValidationMessages.propertiesを作成します。</p>\n<p><img src=\"/2101/3.png\" alt=\"画像\"></p>\n<p>以下のようにメッセージを設定します。今回はブランクに対してのメッセージを修正します</p>\n<div class=\"remark-highlight\"><pre class=\"language-unknown\"><code class=\"language-unknown\">javax.validation.constraints.NotBlank.message=\\u30AB\\u30B9\\u30BF\\u30E0\\u30E1\\u30C3\\u30BB\\u30FC\\u30B8\\u3067\\u3059</code></pre></div>\n<p>この状態でエラーを発生させます。するとメッセージ内容が変更されていることが確認できます。</p>\n<div class=\"remark-highlight\"><pre class=\"language-unknown\"><code class=\"language-unknown\">Field error in object &#x26;#39;storeForm&#x26;#39; on field &#x26;#39;name&#x26;#39;: rejected value []; codes [NotBlank.storeForm.name,NotBlank.name,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [storeForm.name,name]; arguments []; default message [name]]; default message [カスタムメッセージです]\r\r\n</code></pre></div>\n<p>バリデーションについては以下の記事にて記載しています。</p>\n<p><a href=\"/posts/p2083\">リンク</a></p>","slug":"p2101"},"__N_SSG":true}