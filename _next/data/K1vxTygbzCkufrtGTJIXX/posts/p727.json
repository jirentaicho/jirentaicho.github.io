{"pageProps":{"frontMatter":{"title":"Laravel8をロリポップのスタンダートプランにて利用する","date":"2021.12.25","description":"Laravel8をロリポップのスタンダートプランにて利用する","categories":["Laravel"]},"content":"<p>開発環境(Sail)でLaravelプロジェクトを作成→ロリポップにデプロイという流れについて解説します。</p>\n<p>composerとかロリポップ側でインストールとかしません。migrateもしません。ロリポップ側では何もしません。場合によってはstorageに権限を与えてください。</p>\n<p>基本的にFTPでファイルフォルダをアップロードしてしまえば動きます。マイグレーションどうすんの？ってのはMYSQLからデータ引っこ抜いてインポートします。</p>\n<p>まずNetBeansをインストールします。FFFTPだとミスる可能性があります。（理由はわかりません）</p>\n<p>NetBeansの場合は99%失敗無くアップロードできますし、仮に失敗してしまった場合でも見やすいログがあるので再度アップロードすれば問題ありません。</p>\n<p>一旦node_modules以外を全てアップロードしてから、微修正をして修正部分だけ再度アップロードして反映させます。</p>\n<h2>NetBeansの設定</h2>\n<p>インストールしたらプロジェクトをインポートします</p>\n<p>PHP > PHP Application with Existing Sourcesを選択します。</p>\n<p><img src=\"/727/1.png\" alt=\"画像\"></p>\n<p>FTPの設定をします。プロジェクトを右クリックでプロパティ画面を開きます。</p>\n<p>Run ConfigurationからRemoteConnectionのManage…をクリックしてFTPの設定をします。</p>\n<p>また、UploadDirectoryはロリポップ側で利用するフォルダ名にします</p>\n<p>UploadFilesをOnSaveに変更します。→これでアップロードするファイルを手動で選択できるようになります。</p>\n<p><img src=\"/727/2.png\" alt=\"画像\"></p>\n<p>設定ができたらSourceFilesを右クリックでUploadを押してアップロードします。</p>\n<h2>Laravel側の設定</h2>\n<p>ストレージファイルのパスを修正する必要があります。</p>\n<p>\\bootstrap\\cache\\config.php</p>\n<p>これはphp artisan config:cacheを行うと設定が書き変わってしまいます。→config\\loggin.php参照</p>\n<p>その点を留意しておいて、config.phpを暫定処理として修正します。</p>\n<p>config.phpに記載するパスはロリポップ側のstorage/logsのパスになります。↓モザイクばかりですみません。</p>\n<p><img src=\"/727/3.png\" alt=\"画像\"></p>\n<p>sailのプロジェクトでは以下のように設定が記載されますので、該当箇所を全て書き換えます</p>\n<div class=\"remark-highlight\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token operator\">/</span><span class=\"token keyword\">var</span><span class=\"token operator\">/</span>www<span class=\"token operator\">/</span>html<span class=\"token operator\">/</span>storage<span class=\"token operator\">/</span>logs<span class=\"token operator\">/</span>laravel<span class=\"token operator\">.</span>log\n</code></pre></div>\n<p>これはほんの序の口で、viewなどもfullpathが設定されていますので/var/www/html/を一括置換してしまうのが良いです</p>\n<p><img src=\"/727/4.png\" alt=\"画像\"></p>\n<h2>データベース設定</h2>\n<p>ロリポップの接続したいデータベースに対して、ローカル側でエクスポートしたSQLを流します。</p>\n<p>エクスポートについてはSQLクライアントを使えば楽です。</p>\n<p>私はSailのDBに接続したHeidiSQLでエクスポートしました。</p>\n<p>ロリポップで対象のDBをphpmyadminで開いたらエクスポートしたSQLを、対象のデータベースにインポートタブから流します。</p>\n<p>ただ、バイト数が足りないみたいなエラーがおきるのでSQLファイルを修正しました</p>\n<p>utf8mb4_unicode_ci→utf8_unicode_ci</p>\n<p>utf8mb4→utf8</p>\n<h2>ロリポップ側のPHPバージョン変更</h2>\n<p>ロリポップのPHP設定から、PHPのバージョンを8.0CGI版にします。これ遅いんですよね。でもLaravel8を動かすにはこれを選択しないとダメ？っぽい</p>\n<p>とりあえずこれでLaravel8をロリポップのスタンダートプランで動かせました。</p>\n<p>NetBeansをデプロイ用にインストールしたのですが、結構使いやすそうなのでvscodeじゃなくてこっち使おうかな！！</p>","slug":"p727"},"__N_SSG":true}