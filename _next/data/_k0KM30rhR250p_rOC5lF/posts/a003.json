{"pageProps":{"frontMatter":{"title":"Oracle勉強記録1","date":"2022.11.08","description":"Oracleについて","categories":["Oracle"]},"content":"<p>Oracleの環境が折角あるのでOracleの勉強をしましたメモです。<br>\n内容がかなりごちゃ混ぜになっております</p>\n<p>以前DockerにてOracle環境を作成したので、その環境を使ってOracleの勉強をします</p>\n<h1>sysユーザーでsqlplusを使う</h1>\n<p>sqlplus sys as sysdba　でsqlplusを利用する</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">sh<span class=\"token operator\">-</span><span class=\"token number\">4.2</span>$ sqlplus sys <span class=\"token keyword\">as</span> sysdba\n\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">*</span>Plus: <span class=\"token keyword\">Release</span> <span class=\"token number\">21.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span> <span class=\"token operator\">-</span> Production <span class=\"token keyword\">on</span> Tue Nov <span class=\"token number\">8</span> <span class=\"token number\">02</span>:<span class=\"token number\">51</span>:<span class=\"token number\">14</span> <span class=\"token number\">2022</span>\nVersion <span class=\"token number\">21.3</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span>\n\nCopyright <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token number\">1982</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2021</span><span class=\"token punctuation\">,</span> Oracle<span class=\"token punctuation\">.</span>  <span class=\"token keyword\">All</span> rights reserved<span class=\"token punctuation\">.</span>\n\nEnter password:\n\nConnected <span class=\"token keyword\">to</span>:\nOracle <span class=\"token keyword\">Database</span> <span class=\"token number\">21</span>c Express Edition <span class=\"token keyword\">Release</span> <span class=\"token number\">21.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span> <span class=\"token operator\">-</span> Production\nVersion <span class=\"token number\">21.3</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span>\n\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">></span>\n</code></pre></div>\n<p>パスワードは何でも良い？多分設定ができてないかもしれない。何も入力しなくても入れました。（この辺はまた調査します）<br>\nsysユーザは全ての管理機能を実行できるそうです。SYSTEMユーザよりも権力がある<br>\n詳細は<a href=\"https://docs.oracle.com/cd/E57425_01/121/ADMQS/GUID-CF1CD853-AF15-41EC-BC80-61918C73FDB5.htm\">7.3.1 SYSおよびSYSTEMユーザー</a>に記載があります。</p>\n<h1>データベースがMOUNTEDになっている</h1>\n<p>データベースにアクセスできない。開いてませんよと怒られた</p>\n<p><img src=\"/a003/1.png\" alt=\"画像\"></p>\n<p>データベースの情報を見てみるとMOUNTEDになっている。これがOPENになっていないのでおそらく接続ができていない\n<a href=\"https://sql-oracle.com/?p=56#toc6\">Oracleの起動モード(NOMOUNT・MOUNT・OPEN)と使い方</a></p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SQL</span><span class=\"token operator\">></span> <span class=\"token keyword\">show</span> pdbs\n\n    CON_ID CON_NAME                       <span class=\"token keyword\">OPEN</span> <span class=\"token keyword\">MODE</span>  RESTRICTED\n<span class=\"token comment\">---------- ------------------------------ ---------- ----------</span>\n         <span class=\"token number\">2</span> PDB$SEED                       <span class=\"token keyword\">READ</span> ONLY  <span class=\"token keyword\">NO</span>\n         <span class=\"token number\">3</span> XEPDB1                         <span class=\"token keyword\">READ</span> <span class=\"token keyword\">WRITE</span> <span class=\"token keyword\">NO</span>\n         <span class=\"token number\">4</span> PDB01                          MOUNTED\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">></span>\n</code></pre></div>\n<p>というわけでOPENにしてみます<br>\n利用コマンド　alter pluggable database pdb01 open;</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SQL</span><span class=\"token operator\">></span>\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">></span> <span class=\"token keyword\">alter</span> pluggable <span class=\"token keyword\">database</span> pdb01 <span class=\"token keyword\">open</span><span class=\"token punctuation\">;</span>\n\nPluggable <span class=\"token keyword\">database</span> altered<span class=\"token punctuation\">.</span>\n\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">></span> <span class=\"token keyword\">show</span> pdbs\n\n    CON_ID CON_NAME                       <span class=\"token keyword\">OPEN</span> <span class=\"token keyword\">MODE</span>  RESTRICTED\n<span class=\"token comment\">---------- ------------------------------ ---------- ----------</span>\n         <span class=\"token number\">2</span> PDB$SEED                       <span class=\"token keyword\">READ</span> ONLY  <span class=\"token keyword\">NO</span>\n         <span class=\"token number\">3</span> XEPDB1                         <span class=\"token keyword\">READ</span> <span class=\"token keyword\">WRITE</span> <span class=\"token keyword\">NO</span>\n         <span class=\"token number\">4</span> PDB01                          <span class=\"token keyword\">READ</span> <span class=\"token keyword\">WRITE</span> <span class=\"token keyword\">NO</span>\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">></span>\n</code></pre></div>\n<p>何やら状態が変わったのでクライアントから接続をしてみます。</p>\n<p><img src=\"/a003/2.png\" alt=\"画像\"></p>\n<p>接続できました</p>\n<h1>リスナーを止めて動かす</h1>\n<p>正直リスナーというのが詳しくないのですが、クライアントからデータベースへの接続要求に応えるもの。</p>\n<p><a href=\"https://onl.tw/DnasPSD\">Oracle Net接続　リスナーとは</a></p>\n<p>lsnrctl status　コマンドで状態を確認できます。一度sqlplusを抜けてコマンドを実行します</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">sh<span class=\"token operator\">-</span><span class=\"token number\">4.2</span>$ lsnrctl <span class=\"token keyword\">status</span>\n\nLSNRCTL <span class=\"token keyword\">for</span> Linux: Version <span class=\"token number\">21.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span> <span class=\"token operator\">-</span> Production <span class=\"token keyword\">on</span> <span class=\"token number\">08</span><span class=\"token operator\">-</span>NOV<span class=\"token operator\">-</span><span class=\"token number\">2022</span> <span class=\"token number\">04</span>:<span class=\"token number\">23</span>:<span class=\"token number\">06</span>\n\nCopyright <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token number\">1991</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2021</span><span class=\"token punctuation\">,</span> Oracle<span class=\"token punctuation\">.</span>  <span class=\"token keyword\">All</span> rights reserved<span class=\"token punctuation\">.</span>\n\nConnecting <span class=\"token keyword\">to</span> <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>IPC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">KEY</span><span class=\"token operator\">=</span>EXTPROC_FOR_XE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">STATUS</span> <span class=\"token keyword\">of</span> the LISTENER\n<span class=\"token comment\">------------------------</span>\nAlias                     LISTENER\nVersion                   TNSLSNR <span class=\"token keyword\">for</span> Linux: Version <span class=\"token number\">21.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span> <span class=\"token operator\">-</span> Production\n<span class=\"token keyword\">Start</span> <span class=\"token keyword\">Date</span>                <span class=\"token number\">08</span><span class=\"token operator\">-</span>NOV<span class=\"token operator\">-</span><span class=\"token number\">2022</span> <span class=\"token number\">02</span>:<span class=\"token number\">22</span>:<span class=\"token number\">59</span>\nUptime                    <span class=\"token number\">0</span> days <span class=\"token number\">2</span> hr<span class=\"token punctuation\">.</span> <span class=\"token number\">0</span> min<span class=\"token punctuation\">.</span> <span class=\"token number\">7</span> sec\nTrace <span class=\"token keyword\">Level</span>               <span class=\"token keyword\">off</span>\nSecurity                  <span class=\"token keyword\">ON</span>: <span class=\"token keyword\">Local</span> OS Authentication\nSNMP                      <span class=\"token keyword\">OFF</span>\n<span class=\"token keyword\">Default</span> Service           XE\nListener Parameter <span class=\"token keyword\">File</span>   <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>homes<span class=\"token operator\">/</span>OraDBHome21cXE<span class=\"token operator\">/</span>network<span class=\"token operator\">/</span>admin<span class=\"token operator\">/</span>listener<span class=\"token punctuation\">.</span>ora\nListener Log <span class=\"token keyword\">File</span>         <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>diag<span class=\"token operator\">/</span>tnslsnr<span class=\"token operator\">/</span>ecf69755a585<span class=\"token operator\">/</span>listener<span class=\"token operator\">/</span>alert<span class=\"token operator\">/</span>log<span class=\"token punctuation\">.</span>xml\nListening Endpoints Summary<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n  <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>ipc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">KEY</span><span class=\"token operator\">=</span>EXTPROC_FOR_XE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>tcp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HOST<span class=\"token operator\">=</span><span class=\"token number\">0.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>PORT<span class=\"token operator\">=</span><span class=\"token number\">1521</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>tcps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HOST<span class=\"token operator\">=</span>ecf69755a585<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>PORT<span class=\"token operator\">=</span><span class=\"token number\">5500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>Security<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>my_wallet_directory<span class=\"token operator\">=</span><span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>admin<span class=\"token operator\">/</span>XE<span class=\"token operator\">/</span>xdb_wallet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>Presentation<span class=\"token operator\">=</span>HTTP<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">Session</span><span class=\"token operator\">=</span>RAW<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nServices Summary<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nService <span class=\"token string\">\"PLSExtProc\"</span> has <span class=\"token number\">1</span> instance<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>\n  Instance <span class=\"token string\">\"PLSExtProc\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">status</span> UNKNOWN<span class=\"token punctuation\">,</span> has <span class=\"token number\">1</span> <span class=\"token keyword\">handler</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> this service<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nService <span class=\"token string\">\"XE\"</span> has <span class=\"token number\">1</span> instance<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>\n  Instance <span class=\"token string\">\"XE\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">status</span> READY<span class=\"token punctuation\">,</span> has <span class=\"token number\">1</span> <span class=\"token keyword\">handler</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> this service<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nService <span class=\"token string\">\"XEXDB\"</span> has <span class=\"token number\">1</span> instance<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>\n  Instance <span class=\"token string\">\"XE\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">status</span> READY<span class=\"token punctuation\">,</span> has <span class=\"token number\">1</span> <span class=\"token keyword\">handler</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> this service<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nService <span class=\"token string\">\"ea30952669e40a53e0530250a8c0b577\"</span> has <span class=\"token number\">1</span> instance<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>\n  Instance <span class=\"token string\">\"XE\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">status</span> READY<span class=\"token punctuation\">,</span> has <span class=\"token number\">1</span> <span class=\"token keyword\">handler</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> this service<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nService <span class=\"token string\">\"ea36159d93e41cb1e0530250a8c064a9\"</span> has <span class=\"token number\">1</span> instance<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>\n  Instance <span class=\"token string\">\"XE\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">status</span> READY<span class=\"token punctuation\">,</span> has <span class=\"token number\">1</span> <span class=\"token keyword\">handler</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> this service<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nService <span class=\"token string\">\"pdb01\"</span> has <span class=\"token number\">1</span> instance<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>\n  Instance <span class=\"token string\">\"XE\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">status</span> READY<span class=\"token punctuation\">,</span> has <span class=\"token number\">1</span> <span class=\"token keyword\">handler</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> this service<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nService <span class=\"token string\">\"xepdb1\"</span> has <span class=\"token number\">1</span> instance<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>\n  Instance <span class=\"token string\">\"XE\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">status</span> READY<span class=\"token punctuation\">,</span> has <span class=\"token number\">1</span> <span class=\"token keyword\">handler</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> this service<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n</code></pre></div>\n<p>ここにあるlistener.oraというファイルがリスナーの構成と設定を行なっているファイルです。</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">sh<span class=\"token operator\">-</span><span class=\"token number\">4.2</span>$ cat <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>homes<span class=\"token operator\">/</span>OraDBHome21cXE<span class=\"token operator\">/</span>network<span class=\"token operator\">/</span>admin<span class=\"token operator\">/</span>listener<span class=\"token punctuation\">.</span>ora\n<span class=\"token comment\"># listener.ora Network Configuration File:</span>\n\nSID_LIST_LISTENER <span class=\"token operator\">=</span>\n  <span class=\"token punctuation\">(</span>SID_LIST <span class=\"token operator\">=</span>\n    <span class=\"token punctuation\">(</span>SID_DESC <span class=\"token operator\">=</span>\n      <span class=\"token punctuation\">(</span>SID_NAME <span class=\"token operator\">=</span> PLSExtProc<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">(</span>ORACLE_HOME <span class=\"token operator\">=</span> <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>product<span class=\"token operator\">/</span><span class=\"token number\">21</span>c<span class=\"token operator\">/</span>dbhomeXE<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">(</span>PROGRAM <span class=\"token operator\">=</span> extproc<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span>\n\nLISTENER <span class=\"token operator\">=</span>\n  <span class=\"token punctuation\">(</span>DESCRIPTION_LIST <span class=\"token operator\">=</span>\n    <span class=\"token punctuation\">(</span>DESCRIPTION <span class=\"token operator\">=</span>\n      <span class=\"token punctuation\">(</span>ADDRESS <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>PROTOCOL <span class=\"token operator\">=</span> IPC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">KEY</span> <span class=\"token operator\">=</span> EXTPROC_FOR_XE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">(</span>ADDRESS <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>PROTOCOL <span class=\"token operator\">=</span> TCP<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HOST <span class=\"token operator\">=</span> <span class=\"token number\">0.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>PORT <span class=\"token operator\">=</span> <span class=\"token number\">1521</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span>\n\nDEFAULT_SERVICE_LISTENER <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>XE<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>リスナーの情報を取得した時のにAliasがLISTENERというものがありましたが、ここでリスナー名を定義してホストとポートを指定しているみたいです。<br>\nというわけで、このリスナーを停止してクライアントからデータベースに接続をしてみます。</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">sh<span class=\"token operator\">-</span><span class=\"token number\">4.2</span>$ lsnrctl stop LISTENER\n\nLSNRCTL <span class=\"token keyword\">for</span> Linux: Version <span class=\"token number\">21.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span> <span class=\"token operator\">-</span> Production <span class=\"token keyword\">on</span> <span class=\"token number\">08</span><span class=\"token operator\">-</span>NOV<span class=\"token operator\">-</span><span class=\"token number\">2022</span> <span class=\"token number\">04</span>:<span class=\"token number\">44</span>:<span class=\"token number\">21</span>\n\nCopyright <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token number\">1991</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2021</span><span class=\"token punctuation\">,</span> Oracle<span class=\"token punctuation\">.</span>  <span class=\"token keyword\">All</span> rights reserved<span class=\"token punctuation\">.</span>\n\nConnecting <span class=\"token keyword\">to</span> <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>IPC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">KEY</span><span class=\"token operator\">=</span>EXTPROC_FOR_XE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nThe command completed successfully\n</code></pre></div>\n<p>コマンドが成功したので、再度リスナーの状態を取得してみます</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">sh<span class=\"token operator\">-</span><span class=\"token number\">4.2</span>$ lsnrctl <span class=\"token keyword\">status</span>\n\nLSNRCTL <span class=\"token keyword\">for</span> Linux: Version <span class=\"token number\">21.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span> <span class=\"token operator\">-</span> Production <span class=\"token keyword\">on</span> <span class=\"token number\">08</span><span class=\"token operator\">-</span>NOV<span class=\"token operator\">-</span><span class=\"token number\">2022</span> <span class=\"token number\">04</span>:<span class=\"token number\">44</span>:<span class=\"token number\">44</span>\n\nCopyright <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token number\">1991</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2021</span><span class=\"token punctuation\">,</span> Oracle<span class=\"token punctuation\">.</span>  <span class=\"token keyword\">All</span> rights reserved<span class=\"token punctuation\">.</span>\n\nConnecting <span class=\"token keyword\">to</span> <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>IPC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">KEY</span><span class=\"token operator\">=</span>EXTPROC_FOR_XE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nTNS<span class=\"token operator\">-</span><span class=\"token number\">12541</span>: TNS:<span class=\"token keyword\">no</span> listener\n TNS<span class=\"token operator\">-</span><span class=\"token number\">12560</span>: TNS:protocol adapter error\n  TNS<span class=\"token operator\">-</span><span class=\"token number\">00511</span>: <span class=\"token keyword\">No</span> listener\n   Linux Error: <span class=\"token number\">2</span>: <span class=\"token keyword\">No</span> such <span class=\"token keyword\">file</span> <span class=\"token operator\">or</span> directory\nConnecting <span class=\"token keyword\">to</span> <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>TCP<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HOST<span class=\"token operator\">=</span><span class=\"token number\">0.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>PORT<span class=\"token operator\">=</span><span class=\"token number\">1521</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nTNS<span class=\"token operator\">-</span><span class=\"token number\">12541</span>: TNS:<span class=\"token keyword\">no</span> listener\n TNS<span class=\"token operator\">-</span><span class=\"token number\">12560</span>: TNS:protocol adapter error\n  TNS<span class=\"token operator\">-</span><span class=\"token number\">00511</span>: <span class=\"token keyword\">No</span> listener\n   Linux Error: <span class=\"token number\">111</span>: Connection refused\nsh<span class=\"token operator\">-</span><span class=\"token number\">4.2</span>$\n</code></pre></div>\n<p>今度はno listenerと表示されているのでリスナーが機能していないことがわかります。</p>\n<p><img src=\"/a003/3.png\" alt=\"画像\"></p>\n<p>接続しようとすると、今度は別のエラーメッセージが表示されています。<br>\nこのエラーコードは様々な原因で発生するらしいので、一概にリスナーが停止しているからだという判断はできないようです</p>\n<p><a href=\"https://www.projectgroup.info/tips/Oracle/errorcode/ORA-03113.html\">ORA-03113：通信チャネルでend-of-fileが検出されました</a></p>\n<p>リスナーログというのがあるらしいので調べてみます</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">sh<span class=\"token operator\">-</span><span class=\"token number\">4.2</span>$ find <span class=\"token operator\">/</span> <span class=\"token operator\">-</span>name listener<span class=\"token punctuation\">.</span>log\nfind: <span class=\"token string\">'/etc/pki/CA/private'</span>: Permission denied\n<span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>diag<span class=\"token operator\">/</span>tnslsnr<span class=\"token operator\">/</span>ecf69755a585<span class=\"token operator\">/</span>listener<span class=\"token operator\">/</span>trace<span class=\"token operator\">/</span>listener<span class=\"token punctuation\">.</span>log\nfind: <span class=\"token string\">'/root'</span>: Permission denied\nfind: <span class=\"token string\">'/run/cryptsetup'</span>: Permission denied\nfind: <span class=\"token string\">'/proc/tty/driver'</span>: Permission denied\nfind: <span class=\"token string\">'/var/spool/cron'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/yum/history/2022-09-21/1'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/yum/history/2022-09-21/4'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/yum/history/2022-09-21/5'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/yum/history/2022-09-21/2'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/yum/history/2022-09-21/3'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/rpcbind'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/gssproxy/clients'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/gssproxy/rcache'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/machines'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/nfs/statd'</span>: Permission denied\nfind: <span class=\"token string\">'/var/cache/ldconfig'</span>: Permission denied\nfind: <span class=\"token string\">'/var/log/oracle-database-preinstall-21c/results'</span>: Permission denied\nfind: <span class=\"token string\">'/var/log/oracle-database-preinstall-21c/backup/Oct-04-2022-02-44-45'</span>: Permission denied\nsh<span class=\"token operator\">-</span><span class=\"token number\">4.2</span>$\n</code></pre></div>\n<p>一件だけ正常に発見できたので中を見てみます</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">sh<span class=\"token operator\">-</span><span class=\"token number\">4.2</span>$ cat <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>diag<span class=\"token operator\">/</span>tnslsnr<span class=\"token operator\">/</span>ecf69755a585<span class=\"token operator\">/</span>listener<span class=\"token operator\">/</span>trace<span class=\"token operator\">/</span>listener<span class=\"token punctuation\">.</span>log\n<span class=\"token number\">2022</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token operator\">-</span><span class=\"token number\">04</span>T06:<span class=\"token number\">02</span>:<span class=\"token number\">16.058875</span><span class=\"token operator\">+</span><span class=\"token number\">00</span>:<span class=\"token number\">00</span>\n<span class=\"token keyword\">Create</span> Relation ADR_CONTROL\n<span class=\"token keyword\">Create</span> Relation ADR_INVALIDATION\n<span class=\"token keyword\">Create</span> Relation INC_METER_IMPT_DEF\n<span class=\"token keyword\">Create</span> Relation INC_METER_PK_IMPTS\n\nLISTENER <span class=\"token keyword\">for</span> Linux: Version <span class=\"token number\">21.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span> <span class=\"token operator\">-</span> Production\nVersion <span class=\"token number\">21.3</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span>\n\nSystem parameter <span class=\"token keyword\">file</span> <span class=\"token operator\">is</span> <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>homes<span class=\"token operator\">/</span>OraDBHome21cXE<span class=\"token operator\">/</span>network<span class=\"token operator\">/</span>admin<span class=\"token operator\">/</span>listener<span class=\"token punctuation\">.</span>ora\nLog messages written <span class=\"token keyword\">to</span> <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>diag<span class=\"token operator\">/</span>tnslsnr<span class=\"token operator\">/</span>ecf69755a585<span class=\"token operator\">/</span>listener<span class=\"token operator\">/</span>alert<span class=\"token operator\">/</span>log<span class=\"token punctuation\">.</span>xml\nTrace information written <span class=\"token keyword\">to</span> <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>diag<span class=\"token operator\">/</span>tnslsnr<span class=\"token operator\">/</span>ecf69755a585<span class=\"token operator\">/</span>listener<span class=\"token operator\">/</span>trace<span class=\"token operator\">/</span>ora_116_140531036686912<span class=\"token punctuation\">.</span>trc\nTrace <span class=\"token keyword\">level</span> <span class=\"token operator\">is</span> currently <span class=\"token number\">0</span>\n\nStarted <span class=\"token keyword\">with</span> pid<span class=\"token operator\">=</span><span class=\"token number\">116</span>\nListening <span class=\"token keyword\">on</span>: <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>tcp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HOST<span class=\"token operator\">=</span>ecf69755a585<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>PORT<span class=\"token operator\">=</span><span class=\"token number\">1521</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nListening <span class=\"token keyword\">on</span>: <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>ipc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">KEY</span><span class=\"token operator\">=</span>EXTPROC1521<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nListener completed notification <span class=\"token keyword\">to</span> CRS <span class=\"token keyword\">on</span> <span class=\"token keyword\">start</span>\n\n<span class=\"token keyword\">TIMESTAMP</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">CONNECT</span> <span class=\"token keyword\">DATA</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">*</span> PROTOCOL INFO<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> EVENT <span class=\"token punctuation\">[</span><span class=\"token operator\">*</span> SID<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">RETURN</span> CODE\n<span class=\"token number\">04</span><span class=\"token operator\">-</span>OCT<span class=\"token operator\">-</span><span class=\"token number\">2022</span> <span class=\"token number\">06</span>:<span class=\"token number\">02</span>:<span class=\"token number\">16</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>CONNECT_DATA<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>CID<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROGRAM<span class=\"token operator\">=</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HOST<span class=\"token operator\">=</span>ecf69755a585<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">USER</span><span class=\"token operator\">=</span>oracle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>COMMAND<span class=\"token operator\">=</span><span class=\"token keyword\">status</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>ARGUMENTS<span class=\"token operator\">=</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>SERVICE<span class=\"token operator\">=</span>LISTENER<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>VERSION<span class=\"token operator\">=</span><span class=\"token number\">352321536</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>CONNECTION_ID<span class=\"token operator\">=</span><span class=\"token number\">6</span>jAzvo<span class=\"token operator\">+</span>FAG<span class=\"token operator\">/</span>gUwJQqMDBcw<span class=\"token operator\">=</span><span class=\"token operator\">=</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">status</span> <span class=\"token operator\">*</span> <span class=\"token number\">0</span>\n<span class=\"token number\">04</span><span class=\"token operator\">-</span>OCT<span class=\"token operator\">-</span><span class=\"token number\">2022</span> <span class=\"token number\">06</span>:<span class=\"token number\">02</span>:<span class=\"token number\">16</span> <span class=\"token operator\">*</span> ping <span class=\"token operator\">*</span> <span class=\"token number\">0</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n省略\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">2022</span><span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token operator\">-</span><span class=\"token number\">08</span>T02:<span class=\"token number\">35</span>:<span class=\"token number\">24.118408</span><span class=\"token operator\">+</span><span class=\"token number\">00</span>:<span class=\"token number\">00</span>\n<span class=\"token number\">08</span><span class=\"token operator\">-</span>NOV<span class=\"token operator\">-</span><span class=\"token number\">2022</span> <span class=\"token number\">02</span>:<span class=\"token number\">35</span>:<span class=\"token number\">24</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>CONNECT_DATA<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>SERVICE_NAME<span class=\"token operator\">=</span>pdb01<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>CID<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROGRAM<span class=\"token operator\">=</span>A5M2<span class=\"token punctuation\">.</span>exe<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HOST<span class=\"token operator\">=</span>LAPTOP<span class=\"token operator\">-</span>GQK0K0U4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">USER</span><span class=\"token operator\">=</span>kirino<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>tcp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HOST<span class=\"token operator\">=</span><span class=\"token number\">192.168</span><span class=\"token number\">.80</span><span class=\"token number\">.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>PORT<span class=\"token operator\">=</span><span class=\"token number\">38028</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> establish <span class=\"token operator\">*</span> pdb01 <span class=\"token operator\">*</span> <span class=\"token number\">0</span>\n<span class=\"token number\">2022</span><span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token operator\">-</span><span class=\"token number\">08</span>T02:<span class=\"token number\">35</span>:<span class=\"token number\">33.361690</span><span class=\"token operator\">+</span><span class=\"token number\">00</span>:<span class=\"token number\">00</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n省略\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">08</span><span class=\"token operator\">-</span>NOV<span class=\"token operator\">-</span><span class=\"token number\">2022</span> <span class=\"token number\">04</span>:<span class=\"token number\">43</span>:<span class=\"token number\">15</span> <span class=\"token operator\">*</span> service_update <span class=\"token operator\">*</span> XE <span class=\"token operator\">*</span> <span class=\"token number\">0</span>\n<span class=\"token number\">2022</span><span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token operator\">-</span><span class=\"token number\">08</span>T04:<span class=\"token number\">44</span>:<span class=\"token number\">21.388394</span><span class=\"token operator\">+</span><span class=\"token number\">00</span>:<span class=\"token number\">00</span>\n<span class=\"token keyword\">No</span> longer listening <span class=\"token keyword\">on</span>: <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>ipc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">KEY</span><span class=\"token operator\">=</span>EXTPROC_FOR_XE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">No</span> longer listening <span class=\"token keyword\">on</span>: <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>tcp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HOST<span class=\"token operator\">=</span><span class=\"token number\">0.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>PORT<span class=\"token operator\">=</span><span class=\"token number\">1521</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">No</span> longer listening <span class=\"token keyword\">on</span>: <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>tcps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HOST<span class=\"token operator\">=</span>ecf69755a585<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>PORT<span class=\"token operator\">=</span><span class=\"token number\">5500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>Security<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>my_wallet_directory<span class=\"token operator\">=</span><span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>admin<span class=\"token operator\">/</span>XE<span class=\"token operator\">/</span>xdb_wallet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>Presentation<span class=\"token operator\">=</span>HTTP<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">Session</span><span class=\"token operator\">=</span>RAW<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nListener completed notification <span class=\"token keyword\">to</span> CRS <span class=\"token keyword\">on</span> stop\n<span class=\"token number\">08</span><span class=\"token operator\">-</span>NOV<span class=\"token operator\">-</span><span class=\"token number\">2022</span> <span class=\"token number\">04</span>:<span class=\"token number\">44</span>:<span class=\"token number\">21</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>CONNECT_DATA<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>CID<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROGRAM<span class=\"token operator\">=</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HOST<span class=\"token operator\">=</span>ecf69755a585<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">USER</span><span class=\"token operator\">=</span>oracle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>COMMAND<span class=\"token operator\">=</span>stop<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>ARGUMENTS<span class=\"token operator\">=</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>SERVICE<span class=\"token operator\">=</span>LISTENER<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>VERSION<span class=\"token operator\">=</span><span class=\"token number\">352321536</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>CRS<span class=\"token operator\">=</span><span class=\"token keyword\">ON</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>CONNECTION_ID<span class=\"token operator\">=</span><span class=\"token number\">7</span>O8xjxxbE<span class=\"token operator\">/</span>PgUwJQqMCorQ<span class=\"token operator\">=</span><span class=\"token operator\">=</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> stop <span class=\"token operator\">*</span> <span class=\"token number\">0</span>\nsh<span class=\"token operator\">-</span><span class=\"token number\">4.2</span>$\n</code></pre></div>\n<p>一度接続した時に私のローカルマシンのユーザ名でのアクセスを検出しています<br>\nその後、止めてからログは出ていません。当然ですが、このログからはエラーのヒントは何も取得できません。</p>\n<p>ログについては一旦放置してリスナー起動して再度接続を試します</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">sh<span class=\"token operator\">-</span><span class=\"token number\">4.2</span>$ lsnrctl <span class=\"token keyword\">start</span>\n\nLSNRCTL <span class=\"token keyword\">for</span> Linux: Version <span class=\"token number\">21.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span> <span class=\"token operator\">-</span> Production <span class=\"token keyword\">on</span> <span class=\"token number\">08</span><span class=\"token operator\">-</span>NOV<span class=\"token operator\">-</span><span class=\"token number\">2022</span> <span class=\"token number\">06</span>:<span class=\"token number\">27</span>:<span class=\"token number\">50</span>\n\nCopyright <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token number\">1991</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2021</span><span class=\"token punctuation\">,</span> Oracle<span class=\"token punctuation\">.</span>  <span class=\"token keyword\">All</span> rights reserved<span class=\"token punctuation\">.</span>\n\n<span class=\"token keyword\">Starting</span> <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>product<span class=\"token operator\">/</span><span class=\"token number\">21</span>c<span class=\"token operator\">/</span>dbhomeXE<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>tnslsnr: please wait<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\nTNSLSNR <span class=\"token keyword\">for</span> Linux: Version <span class=\"token number\">21.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span> <span class=\"token operator\">-</span> Production\nSystem parameter <span class=\"token keyword\">file</span> <span class=\"token operator\">is</span> <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>homes<span class=\"token operator\">/</span>OraDBHome21cXE<span class=\"token operator\">/</span>network<span class=\"token operator\">/</span>admin<span class=\"token operator\">/</span>listener<span class=\"token punctuation\">.</span>ora\nLog messages written <span class=\"token keyword\">to</span> <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>diag<span class=\"token operator\">/</span>tnslsnr<span class=\"token operator\">/</span>ecf69755a585<span class=\"token operator\">/</span>listener<span class=\"token operator\">/</span>alert<span class=\"token operator\">/</span>log<span class=\"token punctuation\">.</span>xml\nListening <span class=\"token keyword\">on</span>: <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>ipc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">KEY</span><span class=\"token operator\">=</span>EXTPROC_FOR_XE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nListening <span class=\"token keyword\">on</span>: <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>tcp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HOST<span class=\"token operator\">=</span><span class=\"token number\">0.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>PORT<span class=\"token operator\">=</span><span class=\"token number\">1521</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nConnecting <span class=\"token keyword\">to</span> <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>IPC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">KEY</span><span class=\"token operator\">=</span>EXTPROC_FOR_XE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">STATUS</span> <span class=\"token keyword\">of</span> the LISTENER\n<span class=\"token comment\">------------------------</span>\nAlias                     LISTENER\nVersion                   TNSLSNR <span class=\"token keyword\">for</span> Linux: Version <span class=\"token number\">21.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span> <span class=\"token operator\">-</span> Production\n<span class=\"token keyword\">Start</span> <span class=\"token keyword\">Date</span>                <span class=\"token number\">08</span><span class=\"token operator\">-</span>NOV<span class=\"token operator\">-</span><span class=\"token number\">2022</span> <span class=\"token number\">06</span>:<span class=\"token number\">27</span>:<span class=\"token number\">50</span>\nUptime                    <span class=\"token number\">0</span> days <span class=\"token number\">0</span> hr<span class=\"token punctuation\">.</span> <span class=\"token number\">0</span> min<span class=\"token punctuation\">.</span> <span class=\"token number\">0</span> sec\nTrace <span class=\"token keyword\">Level</span>               <span class=\"token keyword\">off</span>\nSecurity                  <span class=\"token keyword\">ON</span>: <span class=\"token keyword\">Local</span> OS Authentication\nSNMP                      <span class=\"token keyword\">OFF</span>\n<span class=\"token keyword\">Default</span> Service           XE\nListener Parameter <span class=\"token keyword\">File</span>   <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>homes<span class=\"token operator\">/</span>OraDBHome21cXE<span class=\"token operator\">/</span>network<span class=\"token operator\">/</span>admin<span class=\"token operator\">/</span>listener<span class=\"token punctuation\">.</span>ora\nListener Log <span class=\"token keyword\">File</span>         <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>diag<span class=\"token operator\">/</span>tnslsnr<span class=\"token operator\">/</span>ecf69755a585<span class=\"token operator\">/</span>listener<span class=\"token operator\">/</span>alert<span class=\"token operator\">/</span>log<span class=\"token punctuation\">.</span>xml\nListening Endpoints Summary<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n  <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>ipc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">KEY</span><span class=\"token operator\">=</span>EXTPROC_FOR_XE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">(</span>DESCRIPTION<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>ADDRESS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>PROTOCOL<span class=\"token operator\">=</span>tcp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HOST<span class=\"token operator\">=</span><span class=\"token number\">0.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>PORT<span class=\"token operator\">=</span><span class=\"token number\">1521</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nServices Summary<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nService <span class=\"token string\">\"PLSExtProc\"</span> has <span class=\"token number\">1</span> instance<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>\n  Instance <span class=\"token string\">\"PLSExtProc\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">status</span> UNKNOWN<span class=\"token punctuation\">,</span> has <span class=\"token number\">1</span> <span class=\"token keyword\">handler</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> this service<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nThe command completed successfully\n</code></pre></div>\n<p>これでクライアントからは正常に接続できるようになりました</p>\n<h1>SIDの確認</h1>\n<p>データベースの特定のインスタンスを識別する名前です。どのデータベースでも、そのデータベースを参照するインスタンスが1つ以上存在します。</p>\n<p><a href=\"https://docs.oracle.com/cd/E16338_01/network.112/b56288/glossary.htm#BGBFBBAI\">Oracleシステム識別子(SID)</a></p>\n<p>SIDの確認方法</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SQL</span><span class=\"token operator\">></span> <span class=\"token keyword\">select</span> instance_name <span class=\"token keyword\">from</span> V$INSTANCE<span class=\"token punctuation\">;</span>\n\nINSTANCE_NAME\n<span class=\"token comment\">----------------</span>\nXE\n</code></pre></div>\n<h1>アラートログの確認</h1>\n<p>いきなりSIDを確認したのはアラートログを確認するためです。アラートログはalert_SID名.logというファイル名になっているそうです</p>\n<div class=\"remark-highlight\"><pre class=\"language-sql\"><code class=\"language-sql\">sh<span class=\"token operator\">-</span><span class=\"token number\">4.2</span>$ find <span class=\"token operator\">/</span> <span class=\"token operator\">-</span>name alert_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>log\nfind: <span class=\"token string\">'/etc/pki/CA/private'</span>: Permission denied\n<span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>oracle<span class=\"token operator\">/</span>diag<span class=\"token operator\">/</span>rdbms<span class=\"token operator\">/</span>xe<span class=\"token operator\">/</span>XE<span class=\"token operator\">/</span>trace<span class=\"token operator\">/</span>alert_XE<span class=\"token punctuation\">.</span>log\nfind: <span class=\"token string\">'/root'</span>: Permission denied\nfind: <span class=\"token string\">'/run/cryptsetup'</span>: Permission denied\nfind: <span class=\"token string\">'/proc/tty/driver'</span>: Permission denied\nfind: <span class=\"token string\">'/var/spool/cron'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/yum/history/2022-09-21/1'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/yum/history/2022-09-21/4'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/yum/history/2022-09-21/5'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/yum/history/2022-09-21/2'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/yum/history/2022-09-21/3'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/rpcbind'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/gssproxy/clients'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/gssproxy/rcache'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/machines'</span>: Permission denied\nfind: <span class=\"token string\">'/var/lib/nfs/statd'</span>: Permission denied\nfind: <span class=\"token string\">'/var/cache/ldconfig'</span>: Permission denied\nfind: <span class=\"token string\">'/var/log/oracle-database-preinstall-21c/results'</span>: Permission denied\nfind: <span class=\"token string\">'/var/log/oracle-database-preinstall-21c/backup/Oct-04-2022-02-44-45'</span>: Permission denied\nsh<span class=\"token operator\">-</span><span class=\"token number\">4.2</span>$\n</code></pre></div>\n<p>alert_XE.logというファイルがヒットしたので確認します</p>\n<div class=\"remark-highlight\"><pre class=\"language-unknown\"><code class=\"language-unknown\">2022-11-08T06:24:09.557260+00:00\nalter pluggable database pdb01 open\n2022-11-08T06:24:09.559594+00:00\nPDB01(4):Pluggable database PDB01 opening in read write\nPDB01(4):SUPLOG: Initialize PDB SUPLOG SGA, old value 0x0, new value 0x18\nPDB01(4):Autotune of undo retention is turned on.\nPDB01(4):Endian type of dictionary set to little\nPDB01(4):Undo initialization recovery: Parallel FPTR failed: start:510862 end:510868 diff:6 ms (0.0 seconds)\nPDB01(4):Undo initialization recovery: err:0 start: 510861 end: 510883 diff: 22 ms (0.0 seconds)\nPDB01(4):[594] Successfully onlined Undo Tablespace 2.\nPDB01(4):Undo initialization online undo segments: err:0 start: 510884 end: 511011 diff: 127 ms (0.1 seconds)\nPDB01(4):Undo initialization finished serial:0 start:510861 end:511015 diff:154 ms (0.2 seconds)\nPDB01(4):Database Characterset for PDB01 is AL32UTF8\nPDB01(4):SUPLOG: Set PDB SUPLOG SGA at PDB OPEN, old 0x18, new 0x0 (no suplog)\n2022-11-08T06:24:10.816380+00:00\nPDB01(4):Opening pdb with Resource Manager plan: DEFAULT_PLAN\nPluggable database PDB01 opened read write\nCompleted: alter pluggable database pdb01 open\n2022-11-08T07:05:49.853008+00:00\nResize operation completed for file# 3, fname /opt/oracle/oradata/XE/sysaux01.dbf, old size 614400K, new size 624640K\nsh-4.2$</code></pre></div>\n<p>しかしここには手掛かりとなるようなログはありませんでした。</p>\n<p>精進します</p>","slug":"a003"},"__N_SSG":true}