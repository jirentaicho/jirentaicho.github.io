<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@site"/><meta name="twitter:creator" content="@keisukesiratori"/><meta property="og:site_name" content="Edelstein"/><title>SpringBootでSpockテスト環境を作る</title><meta name="robots" content="index,follow"/><meta name="description" content="SpringBootでSpockテスト環境を作る"/><meta property="og:title" content="SpringBootでSpockテスト環境を作る"/><meta property="og:description" content="SpringBootでSpockテスト環境を作る"/><meta property="og:url" content="http:localhost:3000/posts/p2548"/><meta property="og:type" content="website"/><meta property="og:image" content="https://locahost:3000/undefined"/><meta property="og:image:alt" content="SpringBootでSpockテスト環境を作る"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="700"/><meta name="next-head-count" content="17"/><link rel="preload" href="/_next/static/css/df6bb53438996960.css" as="style"/><link rel="stylesheet" href="/_next/static/css/df6bb53438996960.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa1640cc84ba8fe.js" defer=""></script><script src="/_next/static/chunks/framework-7751730b10fa0f74.js" defer=""></script><script src="/_next/static/chunks/main-480c748fb908b436.js" defer=""></script><script src="/_next/static/chunks/pages/_app-5a840d570c522cf0.js" defer=""></script><script src="/_next/static/chunks/7-a9ae6bf2d6049209.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-31ed6b5e8c78747a.js" defer=""></script><script src="/_next/static/zySuBojNZUu9-667yIcmf/_buildManifest.js" defer=""></script><script src="/_next/static/zySuBojNZUu9-667yIcmf/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="flex flex-col min-h-screen bg-zinc-800"><header class="sticky top-0 border-b border-zinc-400 z-10 bg-zinc-900 text-slate-400"><div class="max-w-4xl mx-auto flex justify-between items-center h-12"><a href="/">Home</a><a target="_blank" href="https://github.com/jirentaicho">Github</a><a target="_blank" href="https://zenn.dev/misaka">Zenn</a></div></header><main class="flex-1 max-w-4xl w-full mx-auto"><div class="prose prose-lg max-w-none text-emerald-400"><h1 class="mt-12">SpringBootでSpockテスト環境を作る</h1><span>2022.05.23</span><div class="space-x-2"><span><a class="text-emerald-300" href="/categories/Spring/">Spring</a></span></div></div></main><footer class="bg-zinc-900 text-slate-400"><div class="max-w-4xl w-full mx-auto h-24 flex items-center justify-center"><div>© volkruss.com / Edelstein</div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontMatter":{"title":"SpringBootでSpockテスト環境を作る","date":"2022.05.23","description":"SpringBootでSpockテスト環境を作る","categories":["Spring"]},"content":"\u003cp\u003eSpringBootとSpockでテストを行うための環境構築を行います。\u003c/p\u003e\n\u003cp\u003eなんか全然動かなくて困った。。というわけで環境構築編ということでやったことをメモしていきます。\u003c/p\u003e\n\u003cp\u003e起きたエラー\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNo Tests found for given includes\u003c/li\u003e\n\u003cli\u003eThe Spock JUnit runner cannot execute because Spock 1.2.0-groovy-2.4 is not compatible with Groovy 3.0.10\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e環境構築\u003c/h2\u003e\n\u003cp\u003eまずはbuild.gradleにてSpockとGroovyを使うように依存の追加を行います\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003eplugins \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tid \u003cspan class=\"token string\"\u003e'org.springframework.boot'\u003c/span\u003e version \u003cspan class=\"token string\"\u003e'2.6.7'\u003c/span\u003e\n\tid \u003cspan class=\"token string\"\u003e'io.spring.dependency-management'\u003c/span\u003e version \u003cspan class=\"token string\"\u003e'1.0.11.RELEASE'\u003c/span\u003e\n\tid \u003cspan class=\"token string\"\u003e'java'\u003c/span\u003e\n\tid \u003cspan class=\"token string\"\u003e'groovy'\u003c/span\u003e \u003cspan class=\"token comment\"\u003e//追加\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\u003cspan class=\"token property-access\"\u003edependencies\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003e\n\t\u003cspan class=\"token comment\"\u003e// spockのため\u003c/span\u003e\n\ttestImplementation \u003cspan class=\"token string\"\u003e'org.springframework.boot:spring-boot-starter-test'\u003c/span\u003e\n\ttestImplementation \u003cspan class=\"token string\"\u003e'org.spockframework:spock-spring:2.1-groovy-3.0'\u003c/span\u003e\n\ttestImplementation \u003cspan class=\"token string\"\u003e'org.spockframework:spock-core:2.1-groovy-3.0'\u003c/span\u003e\n\timplementation \u003cspan class=\"token string\"\u003e'org.codehaus.gmavenplus:gmavenplus-plugin:1.13.1'\u003c/span\u003e\n\t\u003cspan class=\"token comment\"\u003e// SpockがJunit4でSpringBoot2.2以降がJunit5なので以下で対応\u003c/span\u003e\n\ttestImplementation \u003cspan class=\"token string\"\u003e'org.junit.vintage:junit-vintage-engine:5.8.2'\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eそしてテストクラスは以下のようなgroovyというパッケージを用意しておきます\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/2548/1.png\" alt=\"画像\"\u003e\u003c/p\u003e\n\u003cp\u003eテストクラスはテスト対象のクラスに対してAlt+Enterで作成して、作成したgroovyのパッケージに移動させました。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/2548/2.png\" alt=\"画像\"\u003e\u003c/p\u003e\n\u003cp\u003eGroovyの設定ができてないってエラーになっています\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/2548/3.png\" alt=\"画像\"\u003e\u003c/p\u003e\n\u003cp\u003eConfigure Groovy SDK…をクリックします\u003c/p\u003e\n\u003cp\u003eライブラリがないのでダウンロードにチェックを入れてOKを押します。この時groovy-4.0.0を選んでください。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/2548/4.png\" alt=\"画像\"\u003e\u003c/p\u003e\n\u003cp\u003eこれで表示が消えました\u003c/p\u003e\n\u003cp\u003eあとクラスの右上にGradleのゾウさんマークがあって、そこをクリックしたらCannot resolve symbol ‘spock’ってエラーが消えました→すみませんクリックしたらエラーが解消されてしまったのでキャプチャとか取ってません\u003c/p\u003e\n\u003cp\u003eこれでテストが実行可能になりました\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/2548/5.png\" alt=\"画像\"\u003e\u003c/p\u003e\n\u003cp\u003e参考\u003c/p\u003e\n\u003cp\u003ehttps://www.jetbrains.com/help/idea/getting-started-with-groovy.html#run_groovy\u003c/p\u003e\n\u003ch2\u003eNo Tests found for given includes\u003c/h2\u003e\n\u003cp\u003eこのまま実行しても「No Tests found for given includes」というエラーになりました。\u003c/p\u003e\n\u003cp\u003eこれを解消するにはIntelliJの右上の歯車マークからSettings画面を表示してBuild.Execution,DeploymentからGradleを選択して、Run tests usingのセレクトボックスからIntelliJ IDEAを選択します\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/2548/6.png\" alt=\"画像\"\u003e\u003c/p\u003e\n\u003cp\u003eこれでエラーが消えて実行できるようになります。\u003c/p\u003e\n\u003ch2\u003eThe Spock JUnit runner cannot execute because Spock 1.2.0-groovy-2.4 is not compatible with Groovy 3.0.10\u003c/h2\u003e\n\u003cp\u003eこれはエラーの通りで、うっかりミスをしていました。実はライブラリのダウンロードの時に古いバージョンをダウンロードしてしまいました。\u003c/p\u003e\n\u003cp\u003eプロジェクトを右クリックしてOpen Module Settingsからgroovyを選択して－ボタンを押すとライブラリを削除できます\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/2548/7.png\" alt=\"画像\"\u003e\u003c/p\u003e\n\u003cp\u003eそしたらプロジェクト右クリックでAdd Framework Support…を選択して、もう一度ダウンロードできます。\u003c/p\u003e\n\u003cp\u003eもしダウンロード済でバージョンの指定だけしたい場合はUse libraryから選択できます\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/2548/8.png\" alt=\"画像\"\u003e\u003c/p\u003e\n\u003cp\u003eこれでエラーなくテストが行えるようになりました。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/2548/9.png\" alt=\"画像\"\u003e\u003c/p\u003e\n\u003cp\u003e次回は実際にテストコードを書いていきます\u003c/p\u003e\n\u003ch2\u003e参考\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003ehttps://luran.me/284\n\u003cul\u003e\n\u003cli\u003e韓国語のサイトです\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e","slug":"p2548"},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"p2548"},"buildId":"zySuBojNZUu9-667yIcmf","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>